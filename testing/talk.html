
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Testing &#8212; BB1000 lecture notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="File handling" href="../files/talk.html" />
    <link rel="prev" title="Introduction to git" href="../git/talk.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">BB1000 lecture notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Lecture slides for Programming in Python BB1000
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/talk.html">
   Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../git/talk.html">
   Introduction to git
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../files/talk.html">
   File handling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classes/talk.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../decorators/talk.html">
   Decorators (Advanced topics)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iterators/talk.html">
   Iterators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../profiling/talk.html">
   Profiling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../debugging/talk.html">
   Debugging
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ftesting/talk.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/testing/talk.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bb1000-programming-in-python">
   BB1000 Programming in Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-goals">
   Learning goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-testing">
   Why testing?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-test">
   What is a test?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-test-in-practice">
   What is a test in practice?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-test-driven-development-tdd">
   What is test-driven development (TDD)?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-tdd-work-cycle">
   The TDD work cycle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialize">
     Initialize
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#repeat">
     Repeat
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tools">
   Tools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tools-for-testing-python-code">
     Tools for testing python code
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pytest">
   Pytest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-test">
     Run test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-verbose-test">
     Run verbose test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fix-the-bug">
     Fix the bug
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rerun-test">
     Rerun test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-helper-functions-tests">
   Other helper functions tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#final-tip">
     Final tip
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#links">
     Links
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Testing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bb1000-programming-in-python">
   BB1000 Programming in Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-goals">
   Learning goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-testing">
   Why testing?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-test">
   What is a test?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-test-in-practice">
   What is a test in practice?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-test-driven-development-tdd">
   What is test-driven development (TDD)?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-tdd-work-cycle">
   The TDD work cycle
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialize">
     Initialize
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#repeat">
     Repeat
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tools">
   Tools
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tools-for-testing-python-code">
     Tools for testing python code
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pytest">
   Pytest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example">
   Example
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-test">
     Run test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-verbose-test">
     Run verbose test
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fix-the-bug">
     Fix the bug
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rerun-test">
     Rerun test
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-helper-functions-tests">
   Other helper functions tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#final-tip">
     Final tip
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#links">
     Links
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<section class="tex2jax_ignore mathjax_ignore" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h1>
<section id="bb1000-programming-in-python">
<h2>BB1000 Programming in Python<a class="headerlink" href="#bb1000-programming-in-python" title="Permalink to this headline">#</a></h2>
<p>KTH</p>
<hr class="docutils" />
<p>layout: false</p>
</section>
<section id="learning-goals">
<h2>Learning goals<a class="headerlink" href="#learning-goals" title="Permalink to this headline">#</a></h2>
<p>As a result of taking this module you will be able to</p>
<ul class="simple">
<li><p>Know main reasons for testing</p></li>
<li><p>Develop code with a test-driven development appraoch</p></li>
<li><p>Use one of Python’s main libraries for testing (pytest)</p></li>
<li><p>Know how to prepare tests with fixtures</p></li>
<li><p>Know how to measure how code is covered by tests</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="why-testing">
<h2>Why testing?<a class="headerlink" href="#why-testing" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Make sure the code is correct.</p></li>
<li><p>Testing is a design tool</p></li>
<li><p>Testing is a documentation tool</p></li>
<li><p>It makes for a better design</p></li>
<li><p>Code will never be written that is difficult to test</p></li>
<li><p>Code tends to get better structure</p></li>
<li><p>It’s what professionals do</p></li>
<li><p>Because it saves time and money</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="what-is-a-test">
<h2>What is a test?<a class="headerlink" href="#what-is-a-test" title="Permalink to this headline">#</a></h2>
<p>All testing is based on the <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="o">...</span>                                                                            
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">assert</span></code> command</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">...</span></code> is true, do nothing</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">...</span></code> is false, stop the program</p></li>
<li><p>Can be used to check stuff in production code, e.g. consistent input</p></li>
</ul>
<!--
Run in terminal
```
assert True
assert False
assert 1
assert 0
assert "Hello"
assert ""
assert [1,2,3]
assert []
assert {'a:', 1}
assert {}
```

Simple demo test
-->
<p>Different types of tests</p>
<ul class="simple">
<li><p>unit test: testing of small units of code (programmers view)</p></li>
<li><p>integration test: testing how units work together (clients view)</p></li>
</ul>
<p>Same tools are used for both cases</p>
</section>
<hr class="docutils" />
<section id="what-is-a-test-in-practice">
<h2>What is a test in practice?<a class="headerlink" href="#what-is-a-test-in-practice" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>An single function that uses assert</p>
<ul>
<li><p>to compare actual vs expected result</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">test_slash_join</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">assert</span> <span class="n">slash_join_strings</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;def&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;abc/def&#39;</span>

</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slash_join_strings</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">))</span>

</pre></div>
</div>
<!--
```
>>> test_slash_join()

```
-->
<!--
note explicit naming

in terminal solve
e.g.

execute by hand first
then with pytest
-->
<ul class="simple">
<li><p>Several test functions may be collected in a file</p></li>
<li><p>A test <em>suite</em> is a collection of test files.</p></li>
<li><p>A test <em>runner</em> executes all tests it can find</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="what-is-test-driven-development-tdd">
<h2>What is test-driven development (TDD)?<a class="headerlink" href="#what-is-test-driven-development-tdd" title="Permalink to this headline">#</a></h2>
<p>To add new functionality, most often involves writing a function</p>
<ul class="simple">
<li><p>Make up in your mind what the function should do</p></li>
<li><p>What input is required</p></li>
<li><p>What output is expected</p></li>
<li><p>However, do not code the function just yet…</p></li>
</ul>
<p>In brief</p>
<ul class="simple">
<li><p>Write a test which contains some <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement</p></li>
<li><p>Write code such the test can pass</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="the-tdd-work-cycle">
<h2>The TDD work cycle<a class="headerlink" href="#the-tdd-work-cycle" title="Permalink to this headline">#</a></h2>
<p>Testing a function</p>
<section id="initialize">
<h3>Initialize<a class="headerlink" href="#initialize" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Write a test that</p>
<ul>
<li><p>calls the function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert</span></code> that the actual output and expected output are the same</p></li>
</ul>
</li>
</ul>
</section>
<section id="repeat">
<h3>Repeat<a class="headerlink" href="#repeat" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Run the test</p></li>
<li><p>Did it fail?</p>
<ul>
<li><p>The first time: yes</p></li>
<li><p>Add code to the function with the purpose of passing the test</p></li>
<li><p>Start over</p></li>
</ul>
</li>
<li><p>Did it pass?</p>
<ul>
<li><p>Stop</p></li>
<li><p>Do not write more code. You are done.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">#</a></h2>
<section id="tools-for-testing-python-code">
<h3>Tools for testing python code<a class="headerlink" href="#tools-for-testing-python-code" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>external</p>
<ul>
<li><p>pytest: a commonly used third-party tool for running tests</p></li>
<li><p>nose: same but older</p></li>
</ul>
</li>
<li><p>builtin</p>
<ul>
<li><p>unittest: a module of the standard python library to provide advanced testing</p></li>
<li><p>doctest: a  simple way of including tests in a doc-string of a function</p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="pytest">
<h2>Pytest<a class="headerlink" href="#pytest" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Understands many styles of tests</p></li>
<li><p>The most modern testing framework</p></li>
<li><p>Easy to get started</p></li>
<li><p>Advanced features</p></li>
<li><p>It supports test coverage</p></li>
<li><p>It couples to the python debugger</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h2>
<!--
```
>>> from my import *

```
-->
<p>Consider</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#my_math.py</span>
<span class="k">def</span> <span class="nf">test_my_add</span><span class="p">():</span>
   <span class="k">assert</span> <span class="n">my_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">my_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>

</pre></div>
</div>
<p>Execute the  file with pytest</p>
<ul class="simple">
<li><p>Collects everything that looks like a test</p></li>
<li><p>Executes them one by one</p></li>
</ul>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#my_math.py</span>
<span class="k">def</span> <span class="nf">test_my_add</span><span class="p">():</span>
   <span class="k">assert</span> <span class="n">my_add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">my_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>

</pre></div>
</div>
<hr>
```shell
$ pytest my_math.py
============================= test session starts ==============================
platform linux -- Python 3.6.3, pytest-3.5.0, py-1.5.3, pluggy-0.6.0
rootdir: /home/olav, inifile: pytest.ini
collected 1 item
<p>my_math.py F                                                             [100%]</p>
<p>=================================== FAILURES ===================================
_________________________________ test_my_add __________________________________</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>def test_my_add():
</pre></div>
</div>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span> assert my_add(1, 1) == 2
</pre></div>
</div>
</div></blockquote>
<p>E      assert 0 == 2
E       +  where 0 = my_add(1, 1)</p>
<p>my_math.py:3: AssertionError
=========================== 1 failed in 0.02 seconds ===========================</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>

---
```python
#my_math.py
def test_my_add():
   assert my_add(1, 1) == 2

def my_add(x, y):
    return x + y

</pre></div>
</div>
<hr>
```shell
$ pytest my_math.py
============================= test session starts ==============================
platform linux -- Python 3.6.3, pytest-3.5.0, py-1.5.3, pluggy-0.6.0
rootdir: /home/olav, inifile: pytest.ini
collected 1 item
<p>my_math.py .                                                             [100%]</p>
<p>=========================== 1 passed in 0.00 seconds ===========================</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>

<span class="o">---</span>

<span class="c1">## Exercise</span>

</pre></div>
</div>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>def test_leap_year():
…     assert is_leap_year(2000) == True
…     assert is_leap_year(1999) == False
…     assert is_leap_year(1998) == False
…     assert is_leap_year(1996) == True
…     assert is_leap_year(1900) == False
…     assert is_leap_year(1800) == False
…     assert is_leap_year(1600) == True</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
* Save in a file `test_leap.py`
* Write code in `leap.py`
* Verify with pytest

---

## Test coverage

* Coverage is a measure how much of your code is executed by tests
* During a test run a coverage library keeps track of executed lines
* Guides developer where bugs may hide

How it works (pytest)
* Summary

</pre></div>
</div>
<p>C:\Users…&gt; pytest test_my.py –cov my</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="o">*</span> <span class="n">Line</span> <span class="n">info</span>
</pre></div>
</div>
<p>C:\Users…&gt; pytest test_my.py –cov my –cov-report=term-missing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>

<span class="o">*</span> <span class="n">HTML</span> <span class="n">report</span>

</pre></div>
</div>
<p>C:\Users…&gt; pytest test_my.py –cov my –cov-report=html</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Open</span> <span class="ow">in</span> <span class="n">browser</span>


<span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;cov1.png&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;250&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;cov2.png&quot;</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;250&quot;</span><span class="o">&gt;</span>

<span class="o">---</span>

<span class="c1">## Doctest</span>

<span class="o">*</span> <span class="n">Simple</span> <span class="n">test</span> <span class="n">cases</span> <span class="n">can</span> <span class="n">be</span> <span class="n">provided</span> <span class="k">as</span> <span class="n">part</span> <span class="n">of</span> <span class="n">the</span> <span class="n">documentation</span> <span class="n">string</span>

<span class="o">*</span> <span class="n">Cut</span> <span class="ow">and</span> <span class="n">paste</span> <span class="n">an</span> <span class="n">interactive</span> <span class="n">session</span> <span class="n">known</span> <span class="n">to</span> <span class="n">give</span> <span class="n">true</span> <span class="n">result</span>

<span class="o">*</span> <span class="n">The</span> <span class="n">doctest</span> <span class="n">module</span> <span class="n">executes</span> <span class="n">the</span> <span class="n">example</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">interactive</span> <span class="n">session</span> <span class="k">as</span> <span class="n">a</span> <span class="n">test</span> <span class="n">case</span>
<span class="o">*</span> <span class="n">Test</span> <span class="n">on</span> <span class="n">string</span> <span class="n">output</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">values</span> <span class="o">-</span> <span class="n">small</span> <span class="n">changes</span> <span class="ow">in</span> <span class="n">formatting</span> <span class="n">will</span> <span class="n">case</span> <span class="n">tests</span> <span class="n">to</span> <span class="n">fail</span>

<span class="o">---</span>

<span class="c1">## Example</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#calculate.py
def add(a, b):
    &quot;&quot;&quot;Return sum of two arguments
    &gt;&gt;&gt; add(1, 1) #doctest: +SKIP
    2
    &gt;&gt;&gt;
    &quot;&quot;&quot;
    return a + b

def sub(a, b):
    &quot;&quot;&quot;Return difference of two arguments
    &gt;&gt;&gt; sub(1, 1) #doctest: +SKIP
    0
    &quot;&quot;&quot;
    return a + b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
can you see the bug?

---

## Running doctest

On the command line

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python -m doctest calculate.py
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="o">*</span> <span class="n">All</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">executed</span>
<span class="o">*</span> <span class="n">Functions</span> <span class="n">are</span> <span class="n">defined</span>
<span class="o">*</span> <span class="n">Test</span> <span class="n">are</span> <span class="n">run</span>

<span class="o">---</span>
<span class="c1">### The output</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python calculate.py
**********************************************************************
File &quot;calculate.py&quot;, line 14, in __main__.sub
Failed example:
    sub(1, 1)
Expected:
    0
Got:
    2
**********************************************************************
1 items had failures:
   1 of   1 in __main__.sub
***Test Failed*** 1 failures.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>

<span class="n">Correct</span> <span class="n">the</span> <span class="n">bug</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    return a + b -&gt; return a - b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rerun</span>

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python -m doctest calculate.py
$
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>silent - all ok

---

## Conclusion - doctests

* Very easy to include testning into your code

* The test serves as documentation as well 

* Typically tests only one aspect of the function

* But could clutter your code and may not be the best for extensive testing

* Extensive testing is best separated from production code

* More information on http://docs.python.org/library/doctest

---


## The unittest module



* A unit test module exist for this purpose: `unittest`

* The tests can be written in a separate file

* One defines a class which is a subclass of `unittest.TestCase`

* The unittest framework executes and checks everything that begins with test

* Part of the standard library and provides very portable testing

---

### Howto

* Define a class with a name beginning with ``Test`` as a subclass of ``unittest.TestCase``

* Define class methods that begin with ``test`` using the test functions of the ``unittest`` module

* Optionally one may define a ``setUp`` and a ``tearDown`` method which are run before and after every test.

* In the main section run ``unittest.main()``

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>class TestSomething(unittest.TestCase):
    ...
    def test_this(self):
        ...
    def test_that(self):
        ...
if __name__ == &quot;__main__&quot;:
    unittest.main()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
---

### Example

```python
    #test_calculate.py
    import unittest
    import calculate

    class TestCalculate(unittest.TestCase):
        
        def testadd(self):
            res = calculate.add(1, 1)
            self.assertEqual(res, 2)

        def testsub(self):
            res = calculate.sub(1, 1)
            self.assertEqual(res, 0)

    if __name__ == &quot;__main__&quot;:
        unittest.main()

</pre></div>
</div>
<p>compare  with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#my_math.py</span>
<span class="k">def</span> <span class="nf">test_add</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">calculate</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">test_sub</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">calculate</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

</pre></div>
</div>
<hr class="docutils" />
<section id="run-test">
<h3>Run test<a class="headerlink" href="#run-test" title="Permalink to this headline">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>    $ python test_calculate.py
    .F
    <span class="o">======================================================================</span>
    FAIL: testsub <span class="o">(</span>__main__.TestCalculate<span class="o">)</span>
    ----------------------------------------------------------------------
    Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
      File <span class="s2">&quot;test_calculate.py&quot;</span>, line <span class="m">18</span>, <span class="k">in</span> testsub
        self.assertEqual<span class="o">(</span>res, <span class="m">0</span><span class="o">)</span>
    AssertionError: <span class="m">2</span> !<span class="o">=</span> <span class="m">0</span>

    ----------------------------------------------------------------------
    Ran <span class="m">2</span> tests <span class="k">in</span> <span class="m">0</span>.001s

    FAILED <span class="o">(</span><span class="nv">failures</span><span class="o">=</span><span class="m">1</span><span class="o">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="run-verbose-test">
<h3>Run verbose test<a class="headerlink" href="#run-verbose-test" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    $ python test_calculate.py -v
    testadd (__main__.TestCalculate) ... ok
    testsub (__main__.TestCalculate) ... FAIL

    ======================================================================
    FAIL: testsub (__main__.TestCalculate)
    ----------------------------------------------------------------------
    Traceback (most recent call last):
      File &quot;test_calculate.py&quot;, line 18, in testsub
        self.assertEqual(res, 0)
    AssertionError: 2 != 0

    ----------------------------------------------------------------------
    Ran 2 tests in 0.001s

    FAILED (failures=1)
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="fix-the-bug">
<h3>Fix the bug<a class="headerlink" href="#fix-the-bug" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-&gt;</span> <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</pre></div>
</div>
<p>–</p>
</section>
<section id="rerun-test">
<h3>Rerun test<a class="headerlink" href="#rerun-test" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    $ python test_calculate.py -v
    testadd (__main__.TestCalculate) ... ok
    testsub (__main__.TestCalculate) ... ok

----------------------------------------------------------------------
Ran 2 tests in 0.000s

OK
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="other-helper-functions-tests">
<h2>Other helper functions tests<a class="headerlink" href="#other-helper-functions-tests" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">assertNotEqual</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assertTrue</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assertFalse</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assertAlmostEqual</span></code></p>
<ul>
<li><p>Most numerical testing is within a threshold, e.g.</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="k">def</span> <span class="nf">testdiv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="n">res</span> <span class="o">=</span> <span class="n">calculate</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="mf">0.333333</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>see also http://docs.python.org/3/library/unittest.html</p></li>
</ul>
<hr class="docutils" />
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">pytest</span></code> library is the most modern testing framework for Python</p>
<ul>
<li><p>Easy to get started with simple test functions</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">nose</span></code> is a similar older library</p></li>
<li><p>The standard library contains <code class="docutils literal notranslate"><span class="pre">unittest</span></code> library</p>
<ul>
<li><p>Requires knowledge of classes to code your tests,</p></li>
</ul>
</li>
<li><p>Fine to <code class="docutils literal notranslate"><span class="pre">doctest</span></code> for small illustrations</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="final-tip">
<h3>Final tip<a class="headerlink" href="#final-tip" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Embrace the TDD philosphy, write test before code.</p></li>
<li><p>Document code and modules - be kind to your future self.</p></li>
<li><p>For good programming style, consider PEP 8, http://www.python.org/dev/peps/pep-0008/</p></li>
<li><p>Be obsessive about testing</p></li>
<li><p>If your test code is larger that your production code, you are on the right track</p></li>
<li><p>This takes initially a little more time but the rewards in the long run are huge</p></li>
</ul>
</section>
<section id="links">
<h3>Links<a class="headerlink" href="#links" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>http://pythontesting.net</p></li>
<li><p>http://mathieu.agopian.info/presentations/2015_06_djangocon_europe</p></li>
<li><p>http://katyhuff.github.io/python-testing</p></li>
<li><p><a href="https://www.amazon.com/s/ref=nb_sb_noss_1?url=search-alias%3Dstripbooks&field-keywords=tdd&rh=n%3A283155%2Ck%3Atdd">Amazon search:”TDD”</a> &gt; 100 books</p></li>
<li><p>http://pyvideo.org: <tt>About 80 results</tt></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./testing"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../git/talk.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to git</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../files/talk.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">File handling</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Olav Vahtras<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>